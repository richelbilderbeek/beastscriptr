---
title: "Examples"
author: "RichÃ¨l J.C. Bilderbeek"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Examples}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)

```

# Examples

For all examples, do load `beautier`:

```{r}
library(beautier)
```

All examples read the alignment from a FASTA file called `my_alignment.fas`:

```{r}
input_filename <- "my_alignment.fas"
```

In this vignette, the generated BEAST2 XML is shown.

Use `create_beast2_input_file_from_model` to save the resulting
XML directly to file.

## Example #1: all default

Using all default settings, only specify a DNA alignment.

```{r}
inference_model <- create_inference_model()

create_beast2_input_from_model(
  input_filename,
  inference_model
)
```

All other parameters are set to their defaults, as in BEAUti.

## Example #3: JC69 site model

```{r}
inference_model <- create_inference_model(
  site_model = create_jc69_site_model()
)

create_beast2_input_from_model(
  input_filename,
  inference_model
)
```

## Example #4: Relaxed clock log normal

```{r example_4}
inference_model <- create_inference_model(
  clock_model = create_rln_clock_model()
)

create_beast2_input_from_model(
  input_filename,
  inference_model
)
```

## Example #5: Birth-Death tree prior

```{r example_5}
inference_model <- create_inference_model(
  tree_prior = create_bd_tree_prior() 
)

create_beast2_input_from_model(
  input_filename,
  inference_model
)
```

## Example #6: Yule tree prior with a normally distributed birth rate

```{r example_6}
inference_model <- create_inference_model(
  tree_prior = create_yule_tree_prior(
    birth_rate_distr = create_normal_distr()
  ) 
)

create_beast2_input_from_model(
  input_filename,
  inference_model
)
```

Thanks to Yacine Ben Chehida for this use case

## Example #7: HKY site model with a non-zero proportion of invariants

```{r example_7}
inference_model <- create_inference_model(
  site_model = create_hky_site_model(
    gamma_site_model = create_gamma_site_model(prop_invariant = 0.5)
  )
)

create_beast2_input_from_model(
  input_filename,
  inference_model
)
```

Thanks to Yacine Ben Chehida for this use case

## Example #8: Strict clock with a known clock rate

```{r example_8}
inference_model <- create_inference_model(
  clock_model = create_strict_clock_model(
    clock_rate_param = 0.5
  ) 
)

create_beast2_input_from_model(
  input_filename,
  inference_model
)
```

Thanks to Paul van Els and Yacine Ben Chehida for this use case.

## Example #9: Use MRCA prior

Since `v1.13` it is supported to specify 
an MRCA ('Most Recent Common Ancestor') prior.

```{r example_9}
inference_model <- create_inference_model(
  mrca_prior = create_mrca_prior()
)


create_beast2_input_from_model(
  input_filename,
  inference_model
)
```

## Example #10: Use MRCA prior to specify a close-to-fixed crown age

With an MRCA  prior, it is possible
to specify a close-to-fixed crown age:

```{r example_10}
crown_age <- 15
inference_model <- create_inference_model(
  mrca_prior = create_mrca_prior(
    is_monophyletic = TRUE,
    mrca_distr = create_normal_distr(
      mean = crown_age,
      sigma = 0.001
    )
  )
)

create_beast2_input_from_model(
  input_filename,
  inference_model
)
```
